(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5923:(e,r,t)=>{Promise.resolve().then(t.bind(t,7322))},7322:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var a=t(5155),n=t(2115),s=t(9243),i=t.n(s);let l="chaojia_settings_v1",o={opponentLine:"",intensity:6};function c(){let[e,r]=(0,n.useState)(o.opponentLine),[t,s]=(0,n.useState)(o.intensity),[c,g]=(0,n.useState)(!1),[h,m]=(0,n.useState)([]),[f,y]=(0,n.useState)(!1),[b,x]=(0,n.useState)(null),[N,j]=(0,n.useState)(null),[w,v]=(0,n.useState)(null);(0,n.useEffect)(()=>{try{var e;let t=window.localStorage.getItem(l);if(!t)return;let a=JSON.parse(t);r(null!=(e=a.opponentLine)?e:o.opponentLine),s("number"==typeof a.intensity?d(a.intensity):o.intensity)}catch(e){console.warn("Failed to load local storage settings",e)}finally{g(!0)}},[]),(0,n.useEffect)(()=>{if(c)try{window.localStorage.setItem(l,JSON.stringify({opponentLine:e,intensity:t}))}catch(e){console.warn("Failed to persist settings",e)}},[c,e,t]),(0,n.useEffect)(()=>{if(null===w)return;let e=window.setTimeout(()=>v(null),2200);return()=>window.clearTimeout(e)},[w]);let E=(0,n.useMemo)(()=>(t-1)/9*100,[t]),S=(0,n.useMemo)(()=>({"--progress":"".concat(E,"%")}),[E]),L=async e=>{let r=e.body;if(!r)throw Error("生成失败，请稍后再试。");let t=r.getReader(),a=new TextDecoder("utf-8"),n="",s=null,i=e=>{let r,t=e.trim();if(!t)return;try{r=JSON.parse(t)}catch(e){console.warn("忽略无法解析的流数据",e,t);return}if(!r||"object"!=typeof r)return;let a=r.type;if("partial"===a&&Array.isArray(r.replies)){let e=u(r.replies);e.length>0&&m(e);return}if("complete"===a&&Array.isArray(r.replies)){let e=u(r.replies);e.length>0&&(s=e,m(e),j(new Date));return}if("error"===a){let e=r.error;throw Error("string"==typeof e&&e.trim()?e.trim():"生成失败，请稍后再试。")}};try{for(;;){var l;let{value:e,done:r}=await t.read();if(r)break;let s=(n+=a.decode(e,{stream:!0})).split("\n");for(let e of(n=null!=(l=s.pop())?l:"",s))i(e)}if(n.trim().length>0&&i(n),!Array.isArray(s)||0===s.length)throw Error("生成失败，请稍后再试。")}catch(e){throw await t.cancel(e instanceof Error?e.message:void 0),e}finally{t.releaseLock()}},R=async r=>{if(r.preventDefault(),!e.trim())return void x("先告诉我对方说了什么，才能帮你回击。");y(!0),x(null),v(null),m([]),j(null);try{var a,n,s;let r=await fetch("/api/argue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({opponentLine:e.trim(),intensity:t})});if(!r.ok){let e=await p(r);throw Error((s=e)&&void 0!==s.error&&null!==s.error?"string"==typeof s.error?_(s.error):"object"==typeof s.error&&"message"in s.error&&"string"==typeof s.error.message?_(s.error.message):"生成失败，请稍后再试。":"生成失败，请稍后再试。")}if((null!=(a=r.headers.get("content-type"))?a:"").includes("application/x-ndjson")&&r.body)await L(r);else{let e=await r.json(),t=u(null!=(n=e.replies)?n:[]);if(0===t.length)throw Error("模型没有返回内容，请再试一次。");m(t),j(new Date)}}catch(e){console.error(e),x(e instanceof Error?e.message:"生成失败，请稍后再试。"),m([])}finally{y(!1)}},B=async e=>{if("undefined"==typeof navigator||!navigator.clipboard)return void x("当前浏览器不支持复制，请手动复制。");try{await navigator.clipboard.writeText(e.text),v(e.id)}catch(e){console.error(e),x("复制失败，请手动试试看。")}};return(0,a.jsx)("main",{className:i().page,children:(0,a.jsx)("div",{className:i().content,children:(0,a.jsxs)("section",{className:i().card,children:[(0,a.jsxs)("div",{className:i().headingSection,children:[(0,a.jsx)("h1",{className:i().heading,children:"吵架包赢"}),(0,a.jsx)("p",{className:i().subheading,children:"输入对方的话，调好语气强度，一键生成三条高能反击。"})]}),(0,a.jsxs)("form",{className:i().form,onSubmit:R,children:[(0,a.jsxs)("div",{className:i().fieldGroup,children:[(0,a.jsxs)("div",{className:i().labelRow,children:[(0,a.jsx)("label",{className:i().label,htmlFor:"opponentLine",children:"对方的话"}),(0,a.jsx)("span",{className:i().helper,children:"支持粘贴多段内容"})]}),(0,a.jsx)("textarea",{id:"opponentLine",name:"opponentLine",value:e,onChange:e=>r(e.target.value),placeholder:"比如：你这么笨，少说两句吧。",className:i().textarea,maxLength:800,autoFocus:!0})]}),(0,a.jsxs)("div",{className:i().fieldGroup,children:[(0,a.jsxs)("div",{className:i().labelRow,children:[(0,a.jsx)("span",{className:i().label,children:"语气强烈程度"}),(0,a.jsxs)("span",{className:i().helper,children:[1," 温和 - ",10," 硬刚"]})]}),(0,a.jsxs)("div",{className:i().sliderRow,children:[(0,a.jsx)("input",{type:"range",min:1,max:10,value:t,onChange:e=>s(d(Number.parseInt(e.target.value,10))),className:i().slider,style:S,"aria-label":"语气强烈程度"}),(0,a.jsxs)("div",{className:i().intensityRow,children:[(0,a.jsx)("span",{className:i().helper,children:t<=3?"礼貌但不失锋芒":t<=7?"直接又有分寸":"该出手时就出手"}),(0,a.jsxs)("span",{className:i().intensityBadge,children:[t,"/10"]})]})]})]}),b&&(0,a.jsx)("div",{className:i().error,children:b}),(0,a.jsx)("button",{type:"submit",className:i().submitButton,disabled:f||!e.trim(),children:f?"模型准备中...":"开始吵架"}),f&&(0,a.jsx)("div",{className:i().loadingBar,children:(0,a.jsx)("span",{})})]}),(0,a.jsx)("hr",{className:i().divider}),(0,a.jsxs)("div",{className:i().resultsWrapper,children:[(0,a.jsx)("h2",{className:i().resultsHeading,children:"候选反击"}),0!==h.length||f?(0,a.jsx)("div",{className:i().resultsList,children:h.map(e=>(0,a.jsxs)("article",{className:i().bubble,children:[(0,a.jsx)("p",{children:e.text}),(0,a.jsxs)("footer",{className:i().bubbleFooter,children:[(0,a.jsxs)("span",{children:["强度 ",t,"/10",N?" \xb7 ".concat(function(e){let r=Math.round((new Date().getTime()-e.getTime())/6e4);if(r<=1)return"刚刚";if(r<60)return"".concat(r," 分钟前");let t=Math.round(r/60);return t<24?"".concat(t," 小时前"):e.toLocaleString("zh-CN",{hour12:!1,month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}(N)):null]}),(0,a.jsx)("button",{type:"button",className:i().copyButton,onClick:()=>B(e),children:w===e.id?"已复制":"复制"})]})]},e.id))}):(0,a.jsx)("div",{className:i().emptyState,children:"生成结果会出现在这里。试着输入最刺痛你的一句，看看模型怎么回。"})]})]})})})}function d(e){return Number.isNaN(e)?6:Math.min(Math.max(e,1),10)}async function p(e){try{return await e.json()}catch(e){return console.warn("Failed to parse error payload",e),null}}function u(e){return e.filter(e=>"string"==typeof e&&e.trim().length>0).slice(0,3).map((e,r)=>({id:r+1,text:e.trim()}))}function _(e){let r=e.trim();return r?r.includes("No endpoints found matching your data policy")?"当前密钥未允许使用免费模型（需要开启数据分享）。请前往 OpenRouter 设置：https://openrouter.ai/settings/privacy 启用数据发布或更换其他模型。":r.toLowerCase().includes("provider returned error")?"模型提供方暂时异常，已尝试自动切换。如仍失败，请稍后再试或在 .env.local 中设置 OPENROUTER_MODEL/OPENROUTER_MODELS 更换模型。":r:"生成失败，请稍后再试。"}},9243:e=>{e.exports={page:"page_page__556_G",content:"page_content___38fW",card:"page_card__Cf__u",headingSection:"page_headingSection__s_AwL",heading:"page_heading__eEOyF",subheading:"page_subheading__LKbL_",form:"page_form__NxPAx",fieldGroup:"page_fieldGroup__YxvU4",labelRow:"page_labelRow__UWQnD",label:"page_label__jI4Tf",helper:"page_helper__USBpt",textarea:"page_textarea__aR4ZX",sliderRow:"page_sliderRow__scjGd",slider:"page_slider__EldnE",intensityRow:"page_intensityRow___0uvV",intensityBadge:"page_intensityBadge___P3Gq",submitButton:"page_submitButton__NQB5P",divider:"page_divider__5RusV",resultsWrapper:"page_resultsWrapper__dZRp0",resultsHeading:"page_resultsHeading__jv7o9",resultsList:"page_resultsList__DelbD",bubble:"page_bubble__4l7v_",bubbleFooter:"page_bubbleFooter__orQ4Q",copyButton:"page_copyButton__UNIa2",emptyState:"page_emptyState__j9MME",error:"page_error__JBrsB",loadingBar:"page_loadingBar__khfZU",float:"page_float__Xp_VR"}}},e=>{e.O(0,[572,441,255,358],()=>e(e.s=5923)),_N_E=e.O()}]);